<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Pima Poa League â€” Insights</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Rajdhani:wght@500;600;700&family=Inter:wght@400;600;800&display=swap" rel="stylesheet">

  <link rel="stylesheet" href="css/style.css">
</head>

<body>
  <header class="top">
    <div class="brand">
      <div class="logo">8</div>
      <div>
        <h1>Insights</h1>
        <p class="sub">League trends & analytics</p>
      </div>
    </div>

    <nav class="tabs" aria-label="Site navigation">
      <a class="tab" href="index.html">League</a>
      <a class="tab" href="fixtures.html">Fixtures</a>
      <a class="tab" href="ranking.html">Ranking</a>
      <a class="tab" href="player.html">Player</a>
      <a class="tab active" href="insights.html">Insights</a>
      <a class="tab" href="power.html">Power</a>
    </nav>

    <div class="controls">
      <div id="seasonBadge" class="badge">Season: â€”</div>
      <select id="seasonSelect" class="select"></select>

      <div id="roundBadge" class="badge">Round: â€”</div>
      <select id="roundSelect" class="select"></select>
    </div>
  </header>

  <main class="wrap">
    <div id="insightsError" class="error" style="display:none;"></div>

    <!-- TOP KPI ROW -->
    <section class="card">
      <div class="cardhead">
        <div class="cardtitle">League pulse</div>
        <div class="cardmeta"><span class="tag" id="pulseTag">â€”</span></div>
      </div>

      <div class="spotlightGrid">
        <div class="spotCard">
          <div class="k">âœ… Completion</div>
          <div class="v" id="kpiCompletion">â€”</div>
          <div class="s" id="kpiCompletionSub">â€”</div>
        </div>

        <div class="spotCard">
          <div class="k">ğŸ Current Round</div>
          <div class="v" id="kpiCurrentRound">â€”</div>
          <div class="s" id="kpiCurrentRoundSub">â€”</div>
        </div>

        <div class="spotCard">
          <div class="k">ğŸ”¥ Hottest (last 5)</div>
          <div class="v" id="kpiHot">â€”</div>
          <div class="s" id="kpiHotSub">â€”</div>
        </div>

        <div class="spotCard">
          <div class="k">ğŸ§Š Coldest (last 5)</div>
          <div class="v" id="kpiCold">â€”</div>
          <div class="s" id="kpiColdSub">â€”</div>
        </div>
      </div>
    </section>

    <!-- COMPETITIVENESS -->
    <section class="card">
      <div class="cardhead">
        <div class="cardtitle">Competitiveness</div>
        <div class="cardmeta"><span class="tag">points gaps</span></div>
      </div>

      <div class="spotlightGrid">
        <div class="spotCard">
          <div class="k">ğŸ¥‡ Title race gap</div>
          <div class="v" id="gapTitle">â€”</div>
          <div class="s" id="gapTitleSub">1st vs 2nd</div>
        </div>

        <div class="spotCard">
          <div class="k">ğŸ§± Mid-table spread</div>
          <div class="v" id="gapMid">â€”</div>
          <div class="s" id="gapMidSub">3rd to 6th</div>
        </div>
        
        <div class="spotCard">
          <div class="k">âš ï¸ Bottom danger gap</div>
          <div class="v" id="gapBottom">â€”</div>
          <div class="s" id="gapBottomSub">7th vs 8th</div>
        </div>

        <div class="spotCard">
          <div class="k">ğŸ¯ Bonus activity</div>
          <div class="v" id="bonusActivity">â€”</div>
          <div class="s" id="bonusActivitySub">7B + BP totals</div>
        </div>
      </div>
    </section>

    <section class="card" id="predictorCard">
      <div class="cardhead">
        <div class="cardtitle">Predictor</div>
        <div class="cardmeta">
          <span class="tag">Monte Carlo</span>
        </div>
      </div>

  <div style="display:flex; gap:10px; flex-wrap:wrap; align-items:center; margin-bottom:12px;">
    <div class="badge" id="predMeta">â€”</div>

    <label class="badge" style="display:flex; gap:8px; align-items:center;">
      Sims:
      <select id="simSelect" class="select">
        <option value="2000">2000</option>
        <option value="5000" selected>5000</option>
        <option value="10000">10000</option>
      </select>
    </label>

    <button id="runPredictorBtn" class="btn">Run predictor</button>
  </div>

  <div class="tablewrap">
    <table class="table">
      <thead>
        <tr>
          <th class="col-num">POS</th>
          <th class="col-player">PLAYER</th>
          <th class="col-num">PTS</th>
          <th class="col-num">TITLE %</th>
          <th class="col-num">TOP 5 %</th>
          <th class="col-num">BOTTOM 2 %</th>
          <th class="col-num">EXP PTS</th>
          <th class="col-num">PROJ POS</th>
        </tr>
      </thead>
      <tbody id="predictorBody"></tbody>
    </table>
  </div>

  <p class="footer">
    Uses remaining matches from <code>data/fixtures.csv</code> (Played?=NO) and current table from <code>data/league.csv</code>.
  </p>
</section>
    
    <!-- ROUND BY ROUND PROGRESS -->
    <section class="card">
      <div class="cardhead">
        <div class="cardtitle">Round progress</div>
        <div class="cardmeta"><span class="tag">played / total</span></div>
      </div>

      <div id="roundProgressList"></div>
    </section>

    <!-- UPSETS -->
    <section class="card">
      <div class="cardhead">
        <div class="cardtitle">Upsets</div>
        <div class="cardmeta"><span class="tag">lower pos beat higher pos</span></div>
      </div>

      <div class="tablewrap">
        <table class="table">
          <thead>
            <tr>
              <th class="col-num">RD</th>
              <th class="col-player">WINNER</th>
              <th class="col-player">LOSER</th>
              <th class="col-num">POS Î”</th>
              <th class="col-num">STATUS</th>
            </tr>
          </thead>
          <tbody id="upsetsBody"></tbody>
        </table>
      </div>
      <p class="footer">Upsets use league positions from <code>data/league.csv</code></p>
    </section>

    <!-- WHAT CHANGED THIS ROUND -->
    <section class="card">
      <div class="cardhead">
        <div class="cardtitle">This round (selected)</div>
        <div class="cardmeta"><span class="tag" id="roundTag">â€”</span></div>
      </div>

      <div class="spotlightGrid">
        <div class="spotCard">
          <div class="k">ğŸ† Round MVP</div>
          <div class="v" id="roundMvp">â€”</div>
          <div class="s" id="roundMvpSub">most wins (tie â†’ 7B)</div>
        </div>

        <div class="spotCard">
          <div class="k">âœ… Round record</div>
          <div class="v" id="roundRecord">â€”</div>
          <div class="s" id="roundRecordSub">played / total</div>
        </div>

        <div class="spotCard">
          <div class="k">ğŸ“Œ Most pending</div>
          <div class="v" id="roundPending">â€”</div>
          <div class="s" id="roundPendingSub">players with pending matches</div>
        </div>

        <div class="spotCard">
          <div class="k">ğŸ§¨ Surprise</div>
          <div class="v" id="roundSurprise">â€”</div>
          <div class="s" id="roundSurpriseSub">biggest pos upset</div>
        </div>
      </div>
    </section>

    <p class="footer">Auto-updated from <code>data/fixtures.csv</code> + <code>data/league.csv</code></p>
  </main>

  <script src="js/insights.js"></script>
</body>
</html>
